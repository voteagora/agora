compatibility_date = "2022-11-30"
main = "dist/worker.js"
logpush = true

[env.dev]
name = "optimism-agora-dev"
account_id = "f843baa950d11ddb130ad0f649fc1fa2"
kv_namespaces = [
    { binding = "EMAILS", id = "ac8e3dcdb119401bb0803f4b6104bbf1" }
]
durable_objects.bindings = [
    { name = "STORAGE_OBJECT", class_name = "StorageDurableObjectV1" }
]

[env.dev.vars]
ENVIRONMENT = "dev"
DEPLOYMENT = "optimism"
ADMIN_API_KEY = ''
PRIMARY_DURABLE_OBJECT_INSTANCE_NAME = 'stable8'
BLOCK_STEP_SIZE = "100"
ALLOW_READS_PERCENTAGE = "100"
USE_CACHE_PERCENTAGE = "100"
TENDERLY_USER = "Dom-Mac"
TENDERLY_PROJECT = "project"

[env.prod]
name = "optimism-agora-prod"
account_id = "d0222542a05849995856d260759717d4"
kv_namespaces = [
    { binding = "EMAILS", id = "7e78791e33d044f99fe92b52ced1f774" },
]
durable_objects.bindings = [
    { name = "STORAGE_OBJECT", class_name = "StorageDurableObjectV1" }
]

[env.prod.vars]
ENVIRONMENT = "prod"
DEPLOYMENT = "optimism"
PRIMARY_DURABLE_OBJECT_INSTANCE_NAME = 'bedrock2'
BLOCK_STEP_SIZE = "1000"
ALLOW_READS_PERCENTAGE = "100"
USE_CACHE_PERCENTAGE = "100"
TENDERLY_USER = "Agora"
TENDERLY_PROJECT = "project"

[[migrations]]
tag = "v1" # Should be unique for each entry
new_classes = ["StorageDurableObjectV1"]

[build]
command = "yarn build-worker"

[site]
bucket = "../frontend/build"
